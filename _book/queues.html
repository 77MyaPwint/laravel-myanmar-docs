<!DOCTYPE HTML>
<html lang="en-US" manifest="./manifest.appcache">
    
    <head>
        
        <meta charset="UTF-8">
        <title>Queues | Laravel Framework Documentation (Myanmar)</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 0.5.2">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    
    <link rel="next" href="./security.html" />
    
    
    <link rel="prev" href="./pagination.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="gitbook/style.css">

    
    <link rel="stylesheet" href="gitbook/plugins/plugin-zawgyicss/zawgyi.css">
    


        
    <div class="book"  data-level="3.14" data-basepath="." data-revision="1403607994904">
    <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="./" >Laravel Framework Documentation (Myanmar)</a>
    </h1>
</div>

    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        

        

        

        

        <li data-level="0" data-path="index.html">
            <a href="./"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
    
        <li class="chapter " data-level="1" data-path="introduction.html">
            
            <a href="./introduction.html">
                <i class="fa fa-check"></i> <b>1.</b> Laravel နိဒါန္း
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="introduction.html">
            
            <a href="./introduction.html">
                <i class="fa fa-check"></i> <b>1.1.</b> Laravel မိတ္ဆက္
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="quick.html">
            
            <a href="./quick.html">
                <i class="fa fa-check"></i> <b>1.2.</b> Laravel အက်ဥ္းခ်ဳပ္
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="releases.html">
            
            <a href="./releases.html">
                <i class="fa fa-check"></i> <b>1.3.</b> Release Notes
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="upgrade.html">
            
            <a href="./upgrade.html">
                <i class="fa fa-check"></i> <b>1.4.</b> Upgrade Guide
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="installation.html">
            
            <a href="./installation.html">
                <i class="fa fa-check"></i> <b>2.</b> Laravel ကိုစတင္ေလ႕လာျခင္း (အေျခခံ)
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="installation.html">
            
            <a href="./installation.html">
                <i class="fa fa-check"></i> <b>2.1.</b> Laravel install လုပ္ျခင္း
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="configuration.html">
            
            <a href="./configuration.html">
                <i class="fa fa-check"></i> <b>2.2.</b> Configuration လုပ္ျခင္း
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="homestead.html">
            
            <a href="./homestead.html">
                <i class="fa fa-check"></i> <b>2.3.</b> Laravel ရဲ႕ Official Development Homestead အေၾကာင္း
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="lifecycle.html">
            
            <a href="./lifecycle.html">
                <i class="fa fa-check"></i> <b>2.4.</b> Request Lifecycle 
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="routing.html">
            
            <a href="./routing.html">
                <i class="fa fa-check"></i> <b>2.5.</b> Route လုပ္ျခင္းအေၾကာင္း
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="requests.html">
            
            <a href="./requests.html">
                <i class="fa fa-check"></i> <b>2.6.</b> Requests ႏွင္႕ Input မ်ားအေၾကာင္း 
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="responses.html">
            
            <a href="./responses.html">
                <i class="fa fa-check"></i> <b>2.7.</b> Views ႏွင္႕ Responses မ်ားအေၾကာင္း
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="controllers.html">
            
            <a href="./controllers.html">
                <i class="fa fa-check"></i> <b>2.8.</b> Controllers မ်ားအေၾကာင္း
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="errors.html">
            
            <a href="./errors.html">
                <i class="fa fa-check"></i> <b>2.9.</b> Errors ႏွင္႕ Logging မ်ားအေၾကာင္း
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="security.html">
            
            <a href="./security.html">
                <i class="fa fa-check"></i> <b>3.</b> Laravel ကုိေလ့လာျခင္း (အဆင့္ျမင့္)
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="security.html">
            
            <a href="./security.html">
                <i class="fa fa-check"></i> <b>3.1.</b> Authentication
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="billing.html">
            
            <a href="./billing.html">
                <i class="fa fa-check"></i> <b>3.2.</b> Billing
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="cache.html">
            
            <a href="./cache.html">
                <i class="fa fa-check"></i> <b>3.3.</b> Cache
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="extending.html">
            
            <a href="./extending.html">
                <i class="fa fa-check"></i> <b>3.4.</b> Core Extension
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="events.html">
            
            <a href="./events.html">
                <i class="fa fa-check"></i> <b>3.5.</b> Events
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="facades.html">
            
            <a href="./facades.html">
                <i class="fa fa-check"></i> <b>3.6.</b> Facades
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="html.html">
            
            <a href="./html.html">
                <i class="fa fa-check"></i> <b>3.7.</b> Forms &amp; HTML
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="helpers.html">
            
            <a href="./helpers.html">
                <i class="fa fa-check"></i> <b>3.8.</b> Helpers
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.9" data-path="ioc.html">
            
            <a href="./ioc.html">
                <i class="fa fa-check"></i> <b>3.9.</b> IoC Container
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.10" data-path="localization.html">
            
            <a href="./localization.html">
                <i class="fa fa-check"></i> <b>3.10.</b> Localization
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.11" data-path="mail.html">
            
            <a href="./mail.html">
                <i class="fa fa-check"></i> <b>3.11.</b> Mail
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.12" data-path="packages.html">
            
            <a href="./packages.html">
                <i class="fa fa-check"></i> <b>3.12.</b> Package Development
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.13" data-path="pagination.html">
            
            <a href="./pagination.html">
                <i class="fa fa-check"></i> <b>3.13.</b> Pagination
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.14" data-path="queues.html">
            
            <a href="./queues.html">
                <i class="fa fa-check"></i> <b>3.14.</b> Queues
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.15" data-path="security.html">
            
            <a href="./security.html">
                <i class="fa fa-check"></i> <b>3.15.</b> Security
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.16" data-path="session.html">
            
            <a href="./session.html">
                <i class="fa fa-check"></i> <b>3.16.</b> Session
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.17" data-path="ssh.html">
            
            <a href="./ssh.html">
                <i class="fa fa-check"></i> <b>3.17.</b> SSH
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.18" data-path="templates.html">
            
            <a href="./templates.html">
                <i class="fa fa-check"></i> <b>3.18.</b> Templates
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.19" data-path="testing.html">
            
            <a href="./testing.html">
                <i class="fa fa-check"></i> <b>3.19.</b> Unit Testing
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.20" data-path="validation.html">
            
            <a href="./validation.html">
                <i class="fa fa-check"></i> <b>3.20.</b> Validation
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="database.html">
            
            <a href="./database.html">
                <i class="fa fa-check"></i> <b>4.</b> Database
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="database.html">
            
            <a href="./database.html">
                <i class="fa fa-check"></i> <b>4.1.</b> အေျခခံ အသုံးျပဳပုံ
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="queries.html">
            
            <a href="./queries.html">
                <i class="fa fa-check"></i> <b>4.2.</b> Query Builder
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="eloquent.html">
            
            <a href="./eloquent.html">
                <i class="fa fa-check"></i> <b>4.3.</b> Eloquent ORM
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="schema.html">
            
            <a href="./schema.html">
                <i class="fa fa-check"></i> <b>4.4.</b> Schema Builder
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="migrations.html">
            
            <a href="./migrations.html">
                <i class="fa fa-check"></i> <b>4.5.</b> Migrations &amp; Seeding
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="redis.html">
            
            <a href="./redis.html">
                <i class="fa fa-check"></i> <b>4.6.</b> Redis
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="artisan.html">
            
            <a href="./artisan.html">
                <i class="fa fa-check"></i> <b>5.</b> Artisan CLI
            </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="artisan.html">
            
            <a href="./artisan.html">
                <i class="fa fa-check"></i> <b>5.1.</b> Overview
            </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="commands.html">
            
            <a href="./commands.html">
                <i class="fa fa-check"></i> <b>5.2.</b> Development
            </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="contributing.html">
            
            <a href="./contributing.html">
                <i class="fa fa-check"></i> <b>6.</b> Contributing
            </a>
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 43.90243902439025%;min-width: 41.46341463414634%;"></div>
    </div>
    <div class="chapters">
    
        <a href="./index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="./introduction.html" title="Laravel မိတ္ဆက္" class="chapter done " data-progress="1.1" style="left: 2.4390243902439024%;"></a>
    
        <a href="./quick.html" title="Laravel အက်ဥ္းခ်ဳပ္" class="chapter done " data-progress="1.2" style="left: 4.878048780487805%;"></a>
    
        <a href="./releases.html" title="Release Notes" class="chapter done " data-progress="1.3" style="left: 7.317073170731708%;"></a>
    
        <a href="./upgrade.html" title="Upgrade Guide" class="chapter done " data-progress="1.4" style="left: 9.75609756097561%;"></a>
    
        <a href="./installation.html" title="Laravel install လုပ္ျခင္း" class="chapter done " data-progress="2.1" style="left: 12.195121951219512%;"></a>
    
        <a href="./configuration.html" title="Configuration လုပ္ျခင္း" class="chapter done " data-progress="2.2" style="left: 14.634146341463415%;"></a>
    
        <a href="./homestead.html" title="Laravel ရဲ႕ Official Development Homestead အေၾကာင္း" class="chapter done " data-progress="2.3" style="left: 17.073170731707318%;"></a>
    
        <a href="./lifecycle.html" title="Request Lifecycle " class="chapter done " data-progress="2.4" style="left: 19.51219512195122%;"></a>
    
        <a href="./routing.html" title="Route လုပ္ျခင္းအေၾကာင္း" class="chapter done " data-progress="2.5" style="left: 21.951219512195124%;"></a>
    
        <a href="./requests.html" title="Requests ႏွင္႕ Input မ်ားအေၾကာင္း " class="chapter done " data-progress="2.6" style="left: 24.390243902439025%;"></a>
    
        <a href="./responses.html" title="Views ႏွင္႕ Responses မ်ားအေၾကာင္း" class="chapter done " data-progress="2.7" style="left: 26.829268292682926%;"></a>
    
        <a href="./controllers.html" title="Controllers မ်ားအေၾကာင္း" class="chapter done " data-progress="2.8" style="left: 29.26829268292683%;"></a>
    
        <a href="./errors.html" title="Errors ႏွင္႕ Logging မ်ားအေၾကာင္း" class="chapter done " data-progress="2.9" style="left: 31.70731707317073%;"></a>
    
        <a href="./localization.html" title="Localization" class="chapter done " data-progress="3.10" style="left: 34.146341463414636%;"></a>
    
        <a href="./mail.html" title="Mail" class="chapter done " data-progress="3.11" style="left: 36.58536585365854%;"></a>
    
        <a href="./packages.html" title="Package Development" class="chapter done " data-progress="3.12" style="left: 39.02439024390244%;"></a>
    
        <a href="./pagination.html" title="Pagination" class="chapter done " data-progress="3.13" style="left: 41.46341463414634%;"></a>
    
        <a href="./queues.html" title="Queues" class="chapter done " data-progress="3.14" style="left: 43.90243902439025%;"></a>
    
        <a href="./security.html" title="Security" class="chapter  " data-progress="3.15" style="left: 46.34146341463415%;"></a>
    
        <a href="./session.html" title="Session" class="chapter  " data-progress="3.16" style="left: 48.78048780487805%;"></a>
    
        <a href="./ssh.html" title="SSH" class="chapter  " data-progress="3.17" style="left: 51.21951219512195%;"></a>
    
        <a href="./templates.html" title="Templates" class="chapter  " data-progress="3.18" style="left: 53.65853658536585%;"></a>
    
        <a href="./testing.html" title="Unit Testing" class="chapter  " data-progress="3.19" style="left: 56.09756097560975%;"></a>
    
        <a href="./billing.html" title="Billing" class="chapter  " data-progress="3.2" style="left: 58.53658536585366%;"></a>
    
        <a href="./validation.html" title="Validation" class="chapter  " data-progress="3.20" style="left: 60.97560975609756%;"></a>
    
        <a href="./cache.html" title="Cache" class="chapter  " data-progress="3.3" style="left: 63.41463414634146%;"></a>
    
        <a href="./extending.html" title="Core Extension" class="chapter  " data-progress="3.4" style="left: 65.85365853658537%;"></a>
    
        <a href="./events.html" title="Events" class="chapter  " data-progress="3.5" style="left: 68.29268292682927%;"></a>
    
        <a href="./facades.html" title="Facades" class="chapter  " data-progress="3.6" style="left: 70.73170731707317%;"></a>
    
        <a href="./html.html" title="Forms &amp; HTML" class="chapter  " data-progress="3.7" style="left: 73.17073170731707%;"></a>
    
        <a href="./helpers.html" title="Helpers" class="chapter  " data-progress="3.8" style="left: 75.60975609756098%;"></a>
    
        <a href="./ioc.html" title="IoC Container" class="chapter  " data-progress="3.9" style="left: 78.04878048780488%;"></a>
    
        <a href="./database.html" title="အေျခခံ အသုံးျပဳပုံ" class="chapter  " data-progress="4.1" style="left: 80.48780487804878%;"></a>
    
        <a href="./queries.html" title="Query Builder" class="chapter  " data-progress="4.2" style="left: 82.92682926829268%;"></a>
    
        <a href="./eloquent.html" title="Eloquent ORM" class="chapter  " data-progress="4.3" style="left: 85.36585365853658%;"></a>
    
        <a href="./schema.html" title="Schema Builder" class="chapter  " data-progress="4.4" style="left: 87.8048780487805%;"></a>
    
        <a href="./migrations.html" title="Migrations &amp; Seeding" class="chapter  " data-progress="4.5" style="left: 90.2439024390244%;"></a>
    
        <a href="./redis.html" title="Redis" class="chapter  " data-progress="4.6" style="left: 92.6829268292683%;"></a>
    
        <a href="./artisan.html" title="Overview" class="chapter  " data-progress="5.1" style="left: 95.1219512195122%;"></a>
    
        <a href="./commands.html" title="Development" class="chapter  " data-progress="5.2" style="left: 97.5609756097561%;"></a>
    
        <a href="./contributing.html" title="Contributing" class="chapter  new-chapter" data-progress="6" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_28">
                    
                        <h1 id="queues">Queues</h1>
<ul>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#basic-usage">Basic Usage</a></li>
<li><a href="#queueing-closures">Queueing Closures</a></li>
<li><a href="#running-the-queue-listener">Running The Queue Listener</a></li>
<li><a href="#daemon-queue-worker">Daemon Queue Worker</a></li>
<li><a href="#push-queues">Push Queues</a></li>
<li><a href="#failed-jobs">Failed Jobs</a></li>
</ul>
<p><a name="configuration"></a></p>
<h2 id="configuration">Configuration</h2>
<p>The Laravel Queue component provides a unified API across a variety of different queue services. Queues allow you to defer the processing of a time consuming task, such as sending an e-mail, until a later time, thus drastically speeding up the web requests to your application.</p>
<p>The queue configuration file is stored in <code>app/config/queue.php</code>. In this file you will find connection configurations for each of the queue drivers that are included with the framework, which includes a <a href="http://kr.github.com/beanstalkd" target="_blank">Beanstalkd</a>, <a href="http://iron.io" target="_blank">IronMQ</a>, <a href="http://aws.amazon.com/sqs" target="_blank">Amazon SQS</a>, <a href="http://redis.io" target="_blank">Redis</a>, and synchronous (for local use) driver.</p>
<p>The following dependencies are needed for the listed queue drivers:</p>
<ul>
<li>Beanstalkd: <code>pda/pheanstalk</code></li>
<li>Amazon SQS: <code>aws/aws-sdk-php</code></li>
<li>IronMQ: <code>iron-io/iron_mq</code></li>
</ul>
<p><a name="basic-usage"></a></p>
<h2 id="basic-usage">Basic Usage</h2>
<h4 id="pushing-a-job-onto-the-queue">Pushing A Job Onto The Queue</h4>
<p>To push a new job onto the queue, use the <code>Queue::push</code> method:</p>
<pre><code>Queue::push(&#39;SendEmail&#39;, array(&#39;message&#39; =&gt; $message));
</code></pre><h4 id="defining-a-job-handler">Defining A Job Handler</h4>
<p>The first argument given to the <code>push</code> method is the name of the class that should be used to process the job. The second argument is an array of data that should be passed to the handler. A job handler should be defined like so:</p>
<pre><code>class SendEmail {

    public function fire($job, $data)
    {
        //
    }

}
</code></pre><p>Notice the only method that is required is <code>fire</code>, which receives a <code>Job</code> instance as well as the array of <code>data</code> that was pushed onto the queue.</p>
<h4 id="specifying-a-custom-handler-method">Specifying A Custom Handler Method</h4>
<p>If you want the job to use a method other than <code>fire</code>, you may specify the method when you push the job:</p>
<pre><code>Queue::push(&#39;SendEmail@send&#39;, array(&#39;message&#39; =&gt; $message));
</code></pre><h4 id="specifying-the-queue-tube-for-a-job">Specifying The Queue / Tube For A Job</h4>
<p>You may also specify the queue / tube a job should be sent to:</p>
<pre><code>Queue::push(&#39;SendEmail@send&#39;, array(&#39;message&#39; =&gt; $message), &#39;emails&#39;);
</code></pre><h4 id="passing-the-same-payload-to-multiple-jobs">Passing The Same Payload To Multiple Jobs</h4>
<p>If you need to pass the same data to several queue jobs, you may use the <code>Queue::bulk</code> method:</p>
<pre><code>Queue::bulk(array(&#39;SendEmail&#39;, &#39;NotifyUser&#39;), $payload);
</code></pre><h4 id="delaying-the-execution-of-a-job">Delaying The Execution Of A Job</h4>
<p>Sometimes you may wish to delay the execution of a queued job. For instance, you may wish to queue a job that sends a customer an e-mail 15 minutes after sign-up. You can accomplish this using the <code>Queue::later</code> method:</p>
<pre><code>$date = Carbon::now()-&gt;addMinutes(15);

Queue::later($date, &#39;SendEmail@send&#39;, array(&#39;message&#39; =&gt; $message));
</code></pre><p>In this example, we&#39;re using the <a href="https://github.com/briannesbitt/Carbon" target="_blank">Carbon</a> date library to specify the delay we wish to assign to the job. Alternatively, you may pass the number of seconds you wish to delay as an integer.</p>
<h4 id="deleting-a-processed-job">Deleting A Processed Job</h4>
<p>Once you have processed a job, it must be deleted from the queue, which can be done via the <code>delete</code> method on the <code>Job</code> instance:</p>
<pre><code>public function fire($job, $data)
{
    // Process the job...

    $job-&gt;delete();
}
</code></pre><h4 id="releasing-a-job-back-onto-the-queue">Releasing A Job Back Onto The Queue</h4>
<p>If you wish to release a job back onto the queue, you may do so via the <code>release</code> method:</p>
<pre><code>public function fire($job, $data)
{
    // Process the job...

    $job-&gt;release();
}
</code></pre><p>You may also specify the number of seconds to wait before the job is released:</p>
<pre><code>$job-&gt;release(5);
</code></pre><h4 id="checking-the-number-of-run-attempts">Checking The Number Of Run Attempts</h4>
<p>If an exception occurs while the job is being processed, it will automatically be released back onto the queue. You may check the number of attempts that have been made to run the job using the <code>attempts</code> method:</p>
<pre><code>if ($job-&gt;attempts() &gt; 3)
{
    //
}
</code></pre><h4 id="accessing-the-job-id">Accessing The Job ID</h4>
<p>You may also access the job identifier:</p>
<pre><code>$job-&gt;getJobId();
</code></pre><p><a name="queueing-closures"></a></p>
<h2 id="queueing-closures">Queueing Closures</h2>
<p>You may also push a Closure onto the queue. This is very convenient for quick, simple tasks that need to be queued:</p>
<h4 id="pushing-a-closure-onto-the-queue">Pushing A Closure Onto The Queue</h4>
<pre><code>Queue::push(function($job) use ($id)
{
    Account::delete($id);

    $job-&gt;delete();
});
</code></pre><p>When using Iron.io <a href="#push-queues">push queues</a>, you should take extra precaution queueing Closures. The end-point that receives your queue messages should check for a token to verify that the request is actually from Iron.io. For example, your push queue end-point should be something like: <code>https://yourapp.com/queue/receive?token=SecretToken</code>. You may then check the value of the secret token in your application before marshaling the queue request.</p>
<p><a name="running-the-queue-listener"></a></p>
<h2 id="running-the-queue-listener">Running The Queue Listener</h2>
<p>Laravel includes an Artisan task that will run new jobs as they are pushed onto the queue. You may run this task using the <code>queue:listen</code> command:</p>
<h4 id="starting-the-queue-listener">Starting The Queue Listener</h4>
<pre><code>php artisan queue:listen
</code></pre><p>You may also specify which queue connection the listener should utilize:</p>
<pre><code>php artisan queue:listen connection
</code></pre><p>Note that once this task has started, it will continue to run until it is manually stopped. You may use a process monitor such as <a href="http://supervisord.org/" target="_blank">Supervisor</a> to ensure that the queue listener does not stop running.</p>
<p>You may pass a comma-delimited list of queue connections to the <code>listen</code> command to set queue priorities:</p>
<pre><code>php artisan queue:listen --queue=high,low
</code></pre><p>In this example, jobs on the <code>high-connection</code> will always be processed before moving onto jobs from the <code>low-connection</code>.</p>
<h4 id="specifying-the-job-timeout-parameter">Specifying The Job Timeout Parameter</h4>
<p>You may also set the length of time (in seconds) each job should be allowed to run:</p>
<pre><code>php artisan queue:listen --timeout=60
</code></pre><h4 id="specifying-queue-sleep-duration">Specifying Queue Sleep Duration</h4>
<p>In addition, you may specify the number of seconds to wait before polling for new jobs:</p>
<pre><code>php artisan queue:listen --sleep=5
</code></pre><p>Note that the queue only &quot;sleeps&quot; if no jobs are on the queue. If more jobs are available, the queue will continue to work them without sleeping.</p>
<h4 id="processing-the-first-job-on-the-queue">Processing The First Job On The Queue</h4>
<p>To process only the first job on the queue, you may use the <code>queue:work</code> command:</p>
<pre><code>php artisan queue:work
</code></pre><p><a name="daemon-queue-workers"></a></p>
<h2 id="daemon-queue-workers">Daemon Queue Workers</h2>
<p>The <code>queue:work</code> also includes a <code>--daemon</code> option for forcing the queue worker to continue processing jobs without ever re-booting the framework. This results in a significant reduction of CPU usage when compared to the <code>queue:listen</code> command, but at the added complexity of needing to drain the queues of currently executing jobs during your deployments.</p>
<p>To start a queue worker in daemon mode, use the <code>--daemon</code> flag:</p>
<pre><code>php artisan queue:work connection --daemon

php artisan queue:work connection --daemon --sleep=3

php artisan queue:work connection --daemon --sleep=3 --tries=3
</code></pre><p>As you can see, the <code>queue:work</code> command supports most of the same options available to <code>queue:listen</code>. You may use the <code>php artisan help queue:work</code> command to view all of the available options.</p>
<h3 id="deploying-with-daemon-queue-workers">Deploying With Daemon Queue Workers</h3>
<p>The simplest way to deploy an application using daemon queue workers is to put the application in maintenance mode at the beginning of your deploymnet. This can be done using the <code>php artisan down</code> command. Once the application is in maintenance mode, Laravel will now accept any new jobs off of the queue, but will continue to process existing jobs. Once enough time has passed for all of your existing jobs to execute (usually no longer than 30-60 seconds), you may stop the worker and continue your deployment process.</p>
<p>If you are using Supervisor or Laravel Forge, which utilizes Supervisor, you may typically stop a worker with a command like the following:</p>
<pre><code>supervisorctl stop worker-1
</code></pre><p>Once the queues have been drained and your fresh code has been deployed to your server, you should restart the daemon queue work. If you are using Supervisor, this can typically be done with a command like this:</p>
<pre><code>supervisorctl start worker-1
</code></pre><p><a name="push-queues"></a></p>
<h2 id="push-queues">Push Queues</h2>
<p>Push queues allow you to utilize the powerful Laravel 4 queue facilities without running any daemons or background listeners. Currently, push queues are only supported by the <a href="http://iron.io" target="_blank">Iron.io</a> driver. Before getting started, create an Iron.io account, and add your Iron credentials to the <code>app/config/queue.php</code> configuration file.</p>
<h4 id="registering-a-push-queue-subscriber">Registering A Push Queue Subscriber</h4>
<p>Next, you may use the <code>queue:subscribe</code> Artisan command to register a URL end-point that will receive newly pushed queue jobs:</p>
<pre><code>php artisan queue:subscribe queue_name http://foo.com/queue/receive
</code></pre><p>Now, when you login to your Iron dashboard, you will see your new push queue, as well as the subscribed URL. You may subscribe as many URLs as you wish to a given queue. Next, create a route for your <code>queue/receive</code> end-point and return the response from the <code>Queue::marshal</code> method:</p>
<pre><code>Route::post(&#39;queue/receive&#39;, function()
{
    return Queue::marshal();
});
</code></pre><p>The <code>marshal</code> method will take care of firing the correct job handler class. To fire jobs onto the push queue, just use the same <code>Queue::push</code> method used for conventional queues.</p>
<p><a name="failed-jobs"></a></p>
<h2 id="failed-jobs">Failed Jobs</h2>
<p>Since things don&#39;t always go as planned, sometimes your queued jobs will fail. Don&#39;t worry, it happens to the best of us! Laravel includes a convenient way to specify the maximum number of times a job should be attempted. After a job has exceeded this amount of attempts, it will be inserted into a <code>failed_jobs</code> table. The failed jobs table name can be configured via the <code>app/config/queue.php</code> configuration file.</p>
<p>To create a migration for the <code>failed_jobs</code> table, you may use the <code>queue:failed-table</code> command:</p>
<pre><code>php artisan queue:failed-table
</code></pre><p>You can specify the maximum number of times a job should be attempted using the <code>--tries</code> switch on the <code>queue:listen</code> command:</p>
<pre><code>php artisan queue:listen connection-name --tries=3
</code></pre><p>If you would like to register an event that will be called when a queue job fails, you may use the <code>Queue::failing</code> method. This event is a great opportunity to notify your team via e-mail or <a href="https://www.hipchat.com" target="_blank">HipChat</a>.</p>
<pre><code>Queue::failing(function($connection, $job, $data)
{
    //
});
</code></pre><p>To view all of your failed jobs, you may use the <code>queue:failed</code> Artisan command:</p>
<pre><code>php artisan queue:failed
</code></pre><p>The <code>queue:failed</code> command will list the job ID, connection, queue, and failure time. The job ID may be used to retry the failed job. For instance, to retry a failed job that has an ID of 5, the following command should be issued:</p>
<pre><code>php artisan queue:retry 5
</code></pre><p>If you would like to delete a failed job, you may use the <code>queue:forget</code> command:</p>
<pre><code>php artisan queue:forget 5
</code></pre><p>To delete all of your failed jobs, you may use the <code>queue:flush</code> command:</p>
<pre><code>php artisan queue:flush
</code></pre>
                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="./pagination.html" class="navigation navigation-prev " aria-label="Previous page: Pagination"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./security.html" class="navigation navigation-next " aria-label="Next page: Security"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
<script src="gitbook/app.js"></script>

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
